<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" type="text/css" href="/static/global.min.css">
    <link rel="shortcut icon" type="image/png" href="/static/favicon.png"/>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    
    <title>SkrrrtCoin - Balance</title>
</head>
<body>
    <div class="navbar">
        <a class="logo">
            SkrrrtCoin
        </a>

        <div class="navigation">
            <a class="nav-item" href="/">
                Home
            </a>

            <a class="nav-item" href="/value">
                Value
            </a>

            <a class="nav-item" href="/register">
                Register
            </a>

            <a class="nav-item" href="/balance">
                Balance
            </a>

            <a class="nav-item" href="/transaction">
                Transaction
            </a>

            <a class="nav-item" href="/ranklist">
                Ranklist
            </a>
        </div>
    </div>

    <div class='transaction-main'>
        <div class='transaction'>
            <h2>Transaction</h2>
            <p>enter the information to send the coins</p>

            <section class='transaction-wrapper'>
                <div class='transaction-item show-error disabled'>
                    the information seems to be wrong! please double check what u are typin'
                </div>

                <div class='transaction-item'>
                    <input type='text' placeholder='public-key of the sender' id='sender'/>
                </div>

                <div class='transaction-item'>
                    <input type='password' placeholder='ur private key' id='private-key'/>
                </div>

                <div class='transaction-item'>
                    <input type='text' placeholder='public-key of the receiver' id='receiver'/>
                </div>

                <div class='transaction-item'>
                    <input type='number' placeholder='0' id='amount'/>
                </div>
            </section>

            <div class='button-section'>
                <button class="transaction-button" onClick="postTransaction()">send coins</button>
            </div>
        </div>

        <div class="show-transaction-success disabled">
            <div class="info">
                <h1 class="warning">Transaction finished</h1>
                the transaction of <span class="sent-coins"></span> from <span class="show-sender"></span> to <br>
                <span class="show-receiver"></span> was successfull and gets mined, verified and finished soon...
            </div>
        </div>

        <script>
            function postTransaction() {
                // POST the data
                $.ajax({
                    type: "POST",
                    url: "/api/transaction",
                    data:
                        `sender=${document.getElementById('sender').value}\
                        &private_key=${document.getElementById('private-key').value}\
                        &receiver=${document.getElementById('receiver').value}\
                        &amount=${document.getElementById('amount').value}\
                        &currency=skrt`,

                    success: function (response) {
                        // check if the request was successfull
                        console.log(response)
                        if (!response.succeeded) {
                            $('.show-balance').addClass("disabled");
                            $('.balance').removeClass("disabled");
                            $('.show-error').removeClass("disabled");
                            return;
                        }                         

                        $('.show-transaction-success').removeClass("disabled");
                        $('.transaction').addClass("disabled");
                        $('.show-error').addClass("disabled");

                        document.getElementsByClassName("sent-coins")[0].innerHTML = `SKRT ${document.getElementById('amount').value}`;
                        document.getElementsByClassName("show-sender")[0].innerHTML = document.getElementById('sender').value;
                        document.getElementsByClassName("show-receiver")[0].innerHTML = document.getElementById('receiver').value;
                        return;
                   }
                });
            }
        </script>
    </div>
</body>
</html>